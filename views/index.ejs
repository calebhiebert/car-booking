<!DOCTYPE html>
<html lang="en">
<head>
    <title>Car Booking</title>
    <meta name="google-signin-client_id" content="801316837381-7d1vd6bi6v3c2do02tdqlis0i5b7dsdi.apps.googleusercontent.com">
    <% include head.ejs %>
</head>
<body>
<% include nav.ejs %>
<% include scripts.ejs %>
<% if (sess.tokens === undefined) { %>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">
    </script>
    <script src="https://apis.google.com/js/client:platform.js?onload=start" async defer>
    </script>
    <script>
        let auth2;

        function start() {
            gapi.load('auth2', () => {
                auth2 = gapi.auth2.init({
                    client_id: '801316837381-7d1vd6bi6v3c2do02tdqlis0i5b7dsdi.apps.googleusercontent.com'
                });
            });
        }

        $('#sign-in').click(() => {
            console.log('sign');
            auth2.grantOfflineAccess().then(onSignIn);
        })

        function onSignIn(auth) {
            console.log(auth);
            location.href = '/authentication?code=' + encodeURIComponent(auth.code);
        }
    </script>
<% } %>
</body>
</html>